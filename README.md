# 任务概要

## 数据集

- `protein_mutation_data.csv` 包含突变蛋白质序列(Mut_sequence)，野生型蛋白质序列(wt_sequence)，突变类型(Mutation)，SMILES分子式(SMILES)，回归标签(label)，分类标签(label_cls)。例如，突变类型为"Q257N"的含义是蛋白质第257个氨基酸由Q突变成N，如果存在多个突变则用"/"分隔。

## 任务

- 基于给定数据集，使用深度学习方法预测蛋白质突变体与小分子化合物的结合指标。请分别对回归指标和分类指标进行预测，并给出模型评估结果。

# 模型说明
**目标**：  
预测蛋白质突变体与小分子化合物的结合指标        
**药物分子特征表示**：  
smiles格式转化为2D分子图，然后使用词嵌入方式对原子类型进行编码，GCN作为特征提取器进行特征学习。   
**蛋白质分子特征表示**：  
使用词嵌入方式对fasta格式的序列中的氨基酸类型进行编码。由于每个batch需要长度一致，这里为了避免截取固定长度带来的信息丢失，以及按照最大长度进行填充带来的存储量较高的问题，对每个batch进行动态填充，并使用RNN进行特征学习。另外，设置RNN只关注非填充部分，避免填充的无意义内容的干扰。     
**备注**：  
（其实也可以采用物理化学性质等描述符进行编码，但是需要手动选择特征，比较麻烦。词嵌入方式可以随着反向传播过程自适应地进行更新）
亲和力预测：将药物分子特征表示和蛋白质分子特征表示拼接，输入MLP进行预测输出。   

## 训练过程
首先，对原始数据按行进行随机打乱，避免顺序信息对模型训练的干扰。接着，按照7:3的比例划分训练集和验证集，训练集用于参数更新，验证集来检验每一个Epoch下的性能表现，并保存最佳模型。

## 主要依赖及其版本
python==3.7.13     
torch==1.13.1   
torch-geometric==2.2.0   
rdkit==2023.3.2   
Intel(R)Core(TM)i9-10980XE   
CPU@3.00GHz and 2 GPUs(NVIDIA GeForce RTX 3090)   


## 使用说明和结果文件解释
**分类指标预测**   
```
python ./Code/Classification_code/main.py
```
**结果说明：**  
result.csv 是蛋白质突变体与小分子化合物的分类标签预测结果  
performance_result.xlsx 是对野生型蛋白质的训练集以及测试集的评估指标  

**回归指标预测**  
```
python ./Code/Regression_code/main.py
```
**结果说明：**  
result.csv 是蛋白质突变体与小分子化合物的回归值预测结果  
performance_result.xlsx 是对野生型蛋白质的训练集以及测试集的评估指标  




